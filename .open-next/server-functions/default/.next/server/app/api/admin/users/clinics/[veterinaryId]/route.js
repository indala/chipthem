(()=>{var e={};e.id=5641,e.ids=[5641],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},20417:(e,s,t)=>{"use strict";t.r(s),t.d(s,{patchFetch:()=>g,routeModule:()=>p,serverHooks:()=>x,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>m});var r={};t.r(r),t.d(r,{DELETE:()=>l,PATCH:()=>u});var i=t(40685),n=t(97626),a=t(93465),c=t(64764),o=t(46674);async function u(e,{params:s}){let{veterinaryId:t}=await s;try{let s=await e.json(),{data:r,error:i}=await o.L.from("veterinary_clinics").select("*").eq("id",t).single();if(i||!r)return c.NextResponse.json({success:!1,message:"Clinic not found."},{status:404});let n=new Date,a=s.subscribed_at?new Date(s.subscribed_at):r.subscribed_at?new Date(r.subscribed_at):null,u=s.subscription_expires_at?new Date(s.subscription_expires_at):r.subscription_expires_at?new Date(r.subscription_expires_at):null,l=r.subscription_status||"none";if(u){l=u<n?"expired":"active";let e=(u.getTime()-n.getTime())/864e5;e>=0&&e<=7&&(l="grace_period")}let p={...s,subscription_status:l,updated_at:new Date().toISOString()},{data:d,error:m}=await o.L.from("veterinary_clinics").update(p).eq("id",t).select().single();if(m)return console.error("❌ Clinic update failed:",m),c.NextResponse.json({success:!1,message:"Failed to update clinic."},{status:500});let x=a&&u?{subscribed_at:a.toISOString(),subscription_expires_at:u.toISOString(),remaining_days:Math.ceil((u.getTime()-n.getTime())/864e5),status:l}:null;return c.NextResponse.json({success:!0,message:"Clinic updated successfully.",clinic:d,subscriptionTimeline:x})}catch(e){return console.error("\uD83D\uDD25 Clinic update route error:",e),c.NextResponse.json({success:!1,message:"Internal server error."},{status:500})}}async function l(e,{params:s}){let{veterinaryId:t}=await s;try{let{error:e}=await o.L.from("veterinary_clinics").delete().eq("id",t);if(e)return console.error("❌ Clinic delete failed:",e),c.NextResponse.json({success:!1,message:"Failed to delete clinic."},{status:500});return c.NextResponse.json({success:!0,message:"Clinic deleted successfully."})}catch(e){return console.error("\uD83D\uDD25 Clinic delete route error:",e),c.NextResponse.json({success:!1,message:"Internal server error."},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/users/clinics/[veterinaryId]/route",pathname:"/api/admin/users/clinics/[veterinaryId]",filename:"route",bundlePath:"app/api/admin/users/clinics/[veterinaryId]/route"},resolvedPagePath:"/home/chinnu/projects/chipthem/src/app/api/admin/users/clinics/[veterinaryId]/route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:d,workUnitAsyncStorage:m,serverHooks:x}=p;function g(){return(0,a.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:m})}},63814:()=>{},24494:()=>{},46674:(e,s,t)=>{"use strict";t.d(s,{L:()=>r});let r=(0,t(49103).UU)("https://zwqngfcujvsaahykqisj.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY)}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[3465,3610,9103],()=>t(20417));module.exports=r})();