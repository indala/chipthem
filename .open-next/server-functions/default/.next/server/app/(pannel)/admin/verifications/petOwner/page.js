(()=>{var e={};e.id=7914,e.ids=[7914],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},79551:e=>{"use strict";e.exports=require("url")},33673:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c});var s=r(38413),n=r(97626),i=r(66308),a=r.n(i),o=r(68819),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["(pannel)",{children:["admin",{children:["verifications",{children:["petOwner",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,55445)),"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,35594)),"/home/chinnu/projects/chipthem/src/app/(pannel)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35248,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,42025,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,72470,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,99017))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,12282)),"/home/chinnu/projects/chipthem/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35248,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,42025,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,72470,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,99017))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(pannel)/admin/verifications/petOwner/page",pathname:"/admin/verifications/petOwner",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},15071:(e,t,r)=>{Promise.resolve().then(r.bind(r,55445))},9495:(e,t,r)=>{Promise.resolve().then(r.bind(r,13401))},13401:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(76635),n=r(20830),i=r(5991),a=r(85125);let o=(0,i.v)((e,t)=>({pets:[],page:1,hasMore:!0,loading:!1,error:null,fetchPets:async(r=!1)=>{if(t().loading)return;e({loading:!0,error:null});let s=r?1:t().page;try{let n=await fetch(`/api/admin/pets?page=${s}`),i=await n.json();i.success?e({pets:r?i.pets:[...t().pets,...i.pets],page:s+1,hasMore:i.pagination?.hasMore??!1,loading:!1}):e({loading:!1,error:i.message})}catch(t){console.error("❌ Fetch pets failed:",t),e({loading:!1,error:"Failed to fetch pets."})}},verifyPet:async(r,s)=>{try{let n=await fetch(`/api/admin/pets/${r}/${s}/verify`,{method:"PATCH"}),i=await n.json();if(!i.success)throw Error(i.message);e({pets:t().pets.filter(e=>e.id!==s)})}catch(e){console.error("❌ Verify pet failed:",e)}},rejectPet:async(r,s)=>{try{let n=await fetch(`/api/admin/pets/${r}/${s}/reject`,{method:"DELETE"}),i=await n.json();if(!i.success)throw Error(i.message);e({pets:t().pets.filter(e=>e.id!==s)})}catch(e){console.error("❌ Reject pet failed:",e)}},subscribeRealtime:()=>{let r=a.m.channel("realtime:pets").on("system",{event:"postgres_changes",schema:"public",table:"pets"},r=>{let{eventType:s,new:n,old:i}=r,a=[...t().pets];switch(s){case"INSERT":n&&!a.some(e=>e.id===n.id)&&e({pets:[n,...a]});break;case"UPDATE":n&&e({pets:a.map(e=>e.id===n.id?{...e,...n}:e)});break;case"DELETE":i&&e({pets:a.filter(e=>e.id!==i.id)})}}).subscribe();return()=>a.m.removeChannel(r)}}));var l=r(45105),c=r(38124),d=r(15606),p=r(29051),u=r(53087);let m=({onClick:e,disabled:t,variant:r,size:n,children:i,className:a=""})=>{let o="font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 ";return"sm"===n?o+="px-3 py-1 text-sm ":o+="px-4 py-2 ","success"===r?o+="bg-green-600 hover:bg-green-700 text-white focus:ring-green-300":"danger"===r?o+="bg-red-600 hover:bg-red-700 text-white focus:ring-red-300":"outline-primary"===r?o+="border border-indigo-500 text-indigo-600 hover:bg-indigo-50 focus:ring-indigo-200":o+="bg-gray-200 hover:bg-gray-300 text-gray-800 focus:ring-gray-300",t&&(o+=" opacity-50 cursor-not-allowed"),(0,s.jsx)("button",{onClick:e,disabled:t,className:`${o} ${a}`,children:i})};function h({pet:e,index:t,onView:r}){let{verifyPet:i,rejectPet:a}=o(),[h,x]=(0,n.useState)(!1),f=async()=>{if(!e.id||!e.owner?.id){u.o.error("Missing pet or owner information");return}if(!h){x(!0);try{await u.o.promise(i(e.owner?.id,e.id),{loading:"Verifying pet...",success:"Pet verified successfully!",error:"Failed to verify pet. Please try again."})}finally{x(!1)}}},g=async()=>{if(!e.id||!e.owner?.id){u.o.error("Missing pet or owner information");return}if(!h){x(!0);try{await u.o.promise(a(e.owner?.id,e.id),{loading:"Rejecting pet...",success:"Pet rejected successfully!",error:"Failed to reject pet. Please try again."})}finally{x(!1)}}};return(0,s.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-white border border-gray-200 rounded-xl shadow-md p-4 flex flex-col justify-between h-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("h6",{className:"font-semibold text-lg truncate mb-0 text-gray-800",children:e.pet_name}),e.is_verified?(0,s.jsx)(c.A,{className:"text-green-500",size:20}):"pending"===e.status?(0,s.jsx)(d.A,{className:"text-yellow-500",size:20}):(0,s.jsx)(p.A,{className:"text-red-500",size:20})]}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-1",children:e.pet_type||"Unknown type"}),e.owner&&(0,s.jsxs)("p",{className:"text-gray-500 text-sm mb-3 truncate",children:["\uD83D\uDC64 ",e.owner.full_name," (",e.owner.email,")"]})]}),(0,s.jsxs)("div",{className:"flex justify-between mt-auto space-x-2 pt-3 border-t border-gray-100",children:[(0,s.jsx)(m,{size:"sm",variant:"outline-primary",onClick:()=>r(e),className:"w-1/3",children:"View"}),(0,s.jsx)(m,{size:"sm",variant:"success",disabled:e.is_verified||h,onClick:f,className:"w-1/3",children:"Accept"}),(0,s.jsx)(m,{size:"sm",variant:"danger",disabled:h,onClick:g,className:"w-1/3",children:"Reject"})]})]},e.id)}var x=r(81391);let f=()=>(0,s.jsx)(x.hW,{className:"animate-spin text-indigo-500 w-5 h-5 mr-2"}),g=({onClick:e,disabled:t,variant:r,children:n,className:i=""})=>{let a="px-6 py-3 font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-4 ";return"secondary"===r?a+="bg-gray-500 hover:bg-gray-600 text-white focus:ring-gray-300":"outline-secondary"===r?a+="border border-gray-300 text-gray-700 hover:bg-gray-100 focus:ring-gray-200":a+="bg-indigo-600 hover:bg-indigo-700 text-white focus:ring-indigo-300",t&&(a+=" opacity-50 cursor-not-allowed"),(0,s.jsx)("button",{type:"button",onClick:e,disabled:t,className:`${a} ${i} flex items-center justify-center`,children:n})},b=({show:e,onClose:t,pet:r})=>{let i=(0,n.useRef)(null),a=(0,n.useRef)(null);return((0,n.useEffect)(()=>{if(!e)return;a.current=document.activeElement;let r=e=>{if("Escape"===e.key&&t(),"Tab"===e.key&&i.current){let t=i.current.querySelectorAll('button, a, input, textarea, select, [tabindex]:not([tabindex="-1"])');if(!t.length)return;let r=t[0],s=t[t.length-1];e.shiftKey||document.activeElement!==s||(e.preventDefault(),r.focus()),e.shiftKey&&document.activeElement===r&&(e.preventDefault(),s.focus())}};return window.addEventListener("keydown",r),setTimeout(()=>{i.current?.querySelector("button")?.focus()},0),()=>{window.removeEventListener("keydown",r),a.current?.focus()}},[e,t]),e)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 flex justify-center items-center p-4 z-50","aria-modal":"true",role:"dialog",onClick:t,children:(0,s.jsxs)("div",{ref:i,className:"bg-white rounded-xl shadow-2xl max-w-lg w-full",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-5 border-b",children:[(0,s.jsx)("h5",{className:"text-xl font-bold",children:"Pet Details"}),(0,s.jsx)("button",{type:"button",onClick:t,children:(0,s.jsx)(x.QCr,{className:"w-6 h-6"})})]}),(0,s.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h5",{className:"text-2xl font-semibold mb-1",children:r.pet_name}),(0,s.jsx)("p",{className:"text-gray-500 mb-3",children:r.pet_type||"Unknown type"}),(0,s.jsxs)("div",{className:"bg-gray-100 p-3 rounded mb-4",children:[(0,s.jsx)("strong",{children:"Status:"})," ",r.status||"N/A"," –"," ",(0,s.jsx)("span",{className:r.is_verified?"text-green-600":"text-yellow-600",children:r.is_verified?"Verified":"Unverified"})]}),r.owner&&(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("h6",{className:"font-bold mb-2 flex items-center",children:[(0,s.jsx)(x.x$1,{className:"mr-2"})," Owner"]}),(0,s.jsx)("p",{children:r.owner.full_name}),(0,s.jsx)("p",{children:r.owner.email}),r.owner.phone_number&&(0,s.jsx)("p",{children:r.owner.phone_number}),r.owner.city&&(0,s.jsxs)("p",{children:[r.owner.city,", ",r.owner.country||""]})]})]}):(0,s.jsx)("div",{className:"flex justify-center py-6",children:(0,s.jsx)(f,{})})}),(0,s.jsx)("div",{className:"flex justify-end p-4 border-t",children:(0,s.jsx)(g,{variant:"secondary",onClick:t,children:"Close"})})]})}):null};function y(){let{pets:e,hasMore:t,loading:r}=o(),i=o(e=>e.fetchPets),a=o(e=>e.subscribeRealtime),[l,c]=(0,n.useState)(null),[d,p]=(0,n.useState)(!1),u=(0,n.useCallback)(e=>{i(e)},[i]);(0,n.useCallback)(()=>a(),[a]);let m=e=>{c(e),p(!0)};return(0,s.jsxs)("div",{className:"p-6 md:p-8 bg-gray-50 min-h-screen",children:[(0,s.jsxs)("h2",{className:"text-3xl font-bold mb-6 flex items-center",children:[(0,s.jsx)(x.O21,{className:"mr-3"})," Pet Verification"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:e.map((e,t)=>(0,s.jsx)(h,{pet:e,index:t,onView:m},e.id))}),t&&(0,s.jsx)("div",{className:"text-center mt-8",children:(0,s.jsx)(g,{onClick:()=>u(),disabled:r,variant:"outline-secondary",className:"min-w-[200px]",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f,{})," Loading..."]}):"Load More Pets"})}),(0,s.jsx)(b,{show:d,onClose:()=>p(!1),pet:l})]})}},85125:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});let s=(0,r(98399).UU)("https://zwqngfcujvsaahykqisj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3cW5nZmN1anZzYWFoeWtxaXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNTczNjYsImV4cCI6MjA3NzczMzM2Nn0.TYScA96_QA1pTsZVDty3f4fPDTJRUfbfTtVP9amTuxg")},55445:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(52749).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx","default")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[3465,9233,5580,7757,937,4069,4954],()=>r(33673));module.exports=s})();