(()=>{var e={};e.id=7914,e.ids=[7914],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},33673:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,pages:()=>d,routeModule:()=>m,tree:()=>l});var r=s(38413),n=s(97626),i=s(66308),a=s.n(i),o=s(68819),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["(pannel)",{children:["admin",{children:["verifications",{children:["petOwner",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,55445)),"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,35594)),"/home/chinnu/projects/chipthem/src/app/(pannel)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35248,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,42025,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,72470,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,12282)),"/home/chinnu/projects/chipthem/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35248,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,42025,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,72470,23)),"next/dist/client/components/unauthorized-error"]}],d=["/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx"],p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(pannel)/admin/verifications/petOwner/page",pathname:"/admin/verifications/petOwner",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},15071:(e,t,s)=>{Promise.resolve().then(s.bind(s,55445))},9495:(e,t,s)=>{Promise.resolve().then(s.bind(s,13401))},13401:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(76635),n=s(20830),i=s(50008),a=s(14475),o=s(84403),c=s(85576),l=s(85125);let d=(0,c.v)((e,t)=>({pets:[],page:1,hasMore:!0,loading:!1,error:null,fetchPets:async(s=!1)=>{if(t().loading)return;e({loading:!0,error:null});let r=s?1:t().page;try{let n=await fetch(`/api/admin/pets?page=${r}`),i=await n.json();i.success?e({pets:s?i.pets:[...t().pets,...i.pets],page:r+1,hasMore:i.pagination?.hasMore??!1,loading:!1}):e({loading:!1,error:i.message})}catch(t){console.error("❌ Fetch pets failed:",t),e({loading:!1,error:"Failed to fetch pets."})}},verifyPet:async s=>{try{let r=await fetch(`/api/admin/pets/${s}/verify`,{method:"PATCH"}),n=await r.json();if(!n.success)throw Error(n.message);e({pets:t().pets.map(e=>e.id===s?{...e,is_verified:!0,status:"verified"}:e)})}catch(e){console.error("❌ Verify pet failed:",e)}},rejectPet:async s=>{try{let r=await fetch(`/api/admin/pets/${s}/reject`,{method:"DELETE"}),n=await r.json();if(!n.success)throw Error(n.message);e({pets:t().pets.filter(e=>e.id!==s)})}catch(e){console.error("❌ Reject pet failed:",e)}},subscribeRealtime:()=>{let s=l.m.channel("realtime:pets").on("system",{event:"postgres_changes",schema:"public",table:"pets"},s=>{let{eventType:r,new:n,old:i}=s,a=[...t().pets];switch(r){case"INSERT":n&&!a.some(e=>e.id===n.id)&&e({pets:[n,...a]});break;case"UPDATE":n&&e({pets:a.map(e=>e.id===n.id?{...e,...n}:e)});break;case"DELETE":i&&e({pets:a.filter(e=>e.id!==i.id)})}}).subscribe();return()=>l.m.removeChannel(s)}}));var p=s(45105),m=s(38124),u=s(15606),h=s(29051),x=s(53087);function f({pet:e,index:t,onView:s}){let{verifyPet:n,rejectPet:a}=d();return(0,r.jsxs)(p.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-white border rounded-4 shadow-sm p-3 d-flex flex-column justify-content-between",style:{width:"260px"},children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,r.jsx)("h6",{className:"fw-semibold text-truncate mb-0",children:e.pet_name}),e.is_verified?(0,r.jsx)(m.A,{className:"text-success",size:20}):"pending"===e.status?(0,r.jsx)(u.A,{className:"text-warning",size:20}):(0,r.jsx)(h.A,{className:"text-danger",size:20})]}),(0,r.jsx)("p",{className:"text-muted small mb-1",children:e.pet_type||"Unknown type"}),e.owner&&(0,r.jsxs)("p",{className:"text-muted small mb-3 text-truncate",children:["\uD83D\uDC64 ",e.owner.full_name," (",e.owner.email,")"]}),(0,r.jsxs)("div",{className:"d-flex justify-content-between mt-auto",children:[(0,r.jsx)(i.A,{size:"sm",variant:"outline-primary",onClick:()=>s(e),children:"View"}),(0,r.jsx)(i.A,{size:"sm",variant:"success",disabled:e.is_verified,onClick:()=>{if(!e.id){x.o.error("Missing pet information");return}x.o.promise(n(e.id),{loading:"Verifying pet...",success:"Pet verified successfully!",error:"Failed to verify pet. Please try again."})},children:"Accept"}),(0,r.jsx)(i.A,{size:"sm",variant:"danger",onClick:()=>{if(!e.id){x.o.error("Missing pet information");return}x.o.promise(a(e.id),{loading:"Rejecting pet...",success:"Pet rejected successfully!",error:"Failed to reject pet. Please try again."})},children:"Reject"})]})]},e.id)}function j(){let{pets:e,fetchPets:t,subscribeRealtime:s,hasMore:c,loading:l}=d(),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),x=e=>{m(e),h(!0)},j=()=>h(!1);return(0,r.jsxs)("div",{className:"p-4 bg-light",children:[(0,r.jsx)("h2",{className:"fw-semibold mb-4",children:"\uD83D\uDC3E Pet Verification"}),(0,r.jsx)("div",{className:"d-flex flex-wrap gap-3",children:e.map((e,t)=>(0,r.jsx)(f,{pet:e,index:t,onView:x},e.id))}),c&&(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)(i.A,{onClick:()=>t(),disabled:l,variant:"outline-secondary",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.A,{animation:"border",size:"sm"})," Loading..."]}):"Load More"})}),(0,r.jsxs)(o.A,{show:u,onHide:j,centered:!0,children:[(0,r.jsx)(o.A.Header,{closeButton:!0,children:(0,r.jsx)(o.A.Title,{children:"Pet Details"})}),(0,r.jsx)(o.A.Body,{children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h5",{children:p.pet_name}),(0,r.jsx)("p",{className:"text-muted mb-2",children:p.pet_type||"Unknown type"}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("strong",{children:"Status:"})," ",p.status||"N/A"," – ",p.is_verified?"Verified":"Unverified"]}),p.owner&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h6",{className:"mt-3",children:"\uD83D\uDC64 Owner"}),(0,r.jsx)("p",{children:p.owner.full_name}),(0,r.jsx)("p",{className:"text-muted mb-2",children:p.owner.email}),p.owner.phone_number&&(0,r.jsxs)("p",{className:"text-muted mb-2",children:["\uD83D\uDCDE ",p.owner.phone_number]}),p.owner.city&&(0,r.jsxs)("p",{className:"text-muted",children:["\uD83D\uDCCD ",p.owner.city,", ",p.owner.country||""]})]})]}):(0,r.jsx)("div",{className:"text-center py-3",children:(0,r.jsx)(a.A,{animation:"border"})})}),(0,r.jsx)(o.A.Footer,{children:(0,r.jsx)(i.A,{variant:"secondary",onClick:j,children:"Close"})})]})]})}},85125:(e,t,s)=>{"use strict";s.d(t,{m:()=>r});let r=(0,s(98399).UU)("https://zwqngfcujvsaahykqisj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3cW5nZmN1anZzYWFoeWtxaXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNTczNjYsImV4cCI6MjA3NzczMzM2Nn0.TYScA96_QA1pTsZVDty3f4fPDTJRUfbfTtVP9amTuxg")},55445:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(52749).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/chinnu/projects/chipthem/src/app/(pannel)/admin/verifications/petOwner/page.tsx","default")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[4141,9233,5580,1050,8366,877,102],()=>s(33673));module.exports=r})();