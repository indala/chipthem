(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6693],{69344:(e,s,t)=>{Promise.resolve().then(t.bind(t,11980))},10840:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(22194),r=t(94142),n=t(57284);function o(e){let{children:s,onClose:t,title:o}=e;return(0,a.jsxs)(r.bL,{open:!0,onOpenChange:e=>!e&&t(),children:["a",(0,a.jsx)(r.hJ,{className:"   fixed inset-0    bg-black/40    backdrop-blur-sm    z-[9998]   "}),(0,a.jsxs)(r.UC,{className:"   fixed top-1/2 left-1/2    -translate-x-1/2 -translate-y-1/2   bg-white rounded-xl shadow-xl   w-[90%] max-w-md      /* \uD83D\uDCA5 Fix overflow issue */   max-h-[90vh] overflow-y-auto      /* Smooth scaling animation */   data-[state=open]:animate-in   data-[state=open]:fade-in-0   data-[state=open]:zoom-in-95   data-[state=closed]:animate-out   data-[state=closed]:fade-out-0   data-[state=closed]:zoom-out-95      p-6   z-[9999]   focus:outline-none   ",children:[(0,a.jsx)(r.hE,{className:"text-lg font-semibold mb-3",children:null!=o?o:"Modal"}),(0,a.jsx)(r.bm,{onClick:t,className:"   absolute top-4 right-4    text-gray-500 hover:text-gray-700    transition   ",children:(0,a.jsx)(n.A,{size:20})}),s]})]})}},11980:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(22194),r=t(4346),n=t(61455),o=t(10840);function i(){var e;let{owner:s,isLoading:t,error:i,fetchOwnerData:l,updatePassword:d}=(0,n.K)(),[c,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[h,f]=(0,r.useState)(""),[w,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{s||l()},[s,l]);let y=()=>{x(""),g(""),f(""),b(null)},j=()=>{u(!1)},N=async e=>{if(e.preventDefault(),b(null),!m||!p||!h){b("Please fill all fields.");return}if(p.length<8){b("New password must be at least 8 characters.");return}if(p===m){b("New password must be different from current password.");return}if(p!==h){b("New password and confirmation do not match.");return}if(!s){b("Owner not loaded.");return}await d(s.id,m,p),u(!1)};return t&&!s?(0,a.jsx)("div",{className:"text-center p-12",children:"Loading settings..."}):i&&!s?(0,a.jsx)("div",{className:"text-center p-12 text-red-600",children:(0,a.jsxs)("p",{children:["Error loading settings: ",i]})}):s?(0,a.jsxs)("div",{className:"max-w-3xl mx-auto p-4 sm:p-6 lg:p-8 space-y-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Settings"}),(0,a.jsxs)("section",{className:"bg-white shadow-sm rounded-lg p-4 sm:p-6 border border-gray-100",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Account"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Logged in as ",(0,a.jsx)("span",{className:"font-medium",children:s.email})]})]}),(0,a.jsxs)("section",{className:"bg-white shadow-sm rounded-lg p-4 sm:p-6 border border-gray-100",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Privacy & verification"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Account status:"," ",(0,a.jsx)("span",{className:"font-medium",children:null!==(e=s.status)&&void 0!==e?e:"active"})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Verified:"," ",(0,a.jsx)("span",{className:"font-medium",children:s.is_verified?"Yes":"No"})]})]}),(0,a.jsxs)("section",{className:"bg-white shadow-sm rounded-lg p-4 sm:p-6 border border-gray-100 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Security"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Change your password to keep your account secure."})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{y(),u(!0)},className:"mt-3 sm:mt-0 inline-flex items-center justify-center rounded-full bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-700 transition",children:"Change password"})]}),c&&(0,a.jsx)(o.A,{title:"Change password",onClose:j,children:(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-xs font-semibold text-gray-700",children:"Current password"}),(0,a.jsx)("input",{type:"password",value:m,onChange:e=>x(e.target.value),className:"w-full rounded-md border border-gray-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/70"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-xs font-semibold text-gray-700",children:"New password"}),(0,a.jsx)("input",{type:"password",value:p,onChange:e=>g(e.target.value),className:"w-full rounded-md border border-gray-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/70"}),(0,a.jsx)("p",{className:"text-[11px] text-gray-500",children:"Must be at least 8 characters and different from your current password."})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-xs font-semibold text-gray-700",children:"Confirm new password"}),(0,a.jsx)("input",{type:"password",value:h,onChange:e=>f(e.target.value),className:"w-full rounded-md border border-gray-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/70"})]}),w&&(0,a.jsx)("p",{className:"text-xs text-red-600 font-medium",children:w}),(0,a.jsxs)("div",{className:"pt-2 flex justify-end gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:j,className:"px-3 py-1.5 text-xs font-semibold rounded-full border border-gray-200 text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-1.5 text-xs font-semibold rounded-full bg-indigo-600 text-white shadow hover:bg-indigo-700",children:"Save password"})]})]})})]}):(0,a.jsx)("div",{className:"text-center p-12",children:"No owner data found."})}},61455:(e,s,t)=>{"use strict";t.d(s,{K:()=>n});var a=t(16474);let r=async(e,s)=>{let t=await fetch(e,s);if(!t.ok)throw Error((await t.json()).error||"API request failed");return t},n=(0,a.v)((e,s)=>({owner:null,pets:[],isLoading:!1,error:null,fetchOwnerData:async()=>{e({isLoading:!0,error:null});try{let s=await r("/api/owner/me",{}),t=await s.json();e({owner:t.owner,pets:t.pets,isLoading:!1})}catch(t){let s=t instanceof Error?t.message:"Unknown error";e({error:s,isLoading:!1}),console.error("Error fetching owner data:",s)}},updateOwner:async(t,a)=>{e({isLoading:!0,error:null});try{await r("/api/owner/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),await s().fetchOwnerData(),e({isLoading:!1})}catch(t){let s=t instanceof Error?t.message:"Unknown error";e({error:s,isLoading:!1}),console.error("Error updating owner:",s)}},updatePet:async(t,a)=>{e({isLoading:!0,error:null});try{await r("/api/pet/".concat(t),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),await s().fetchOwnerData(),e({isLoading:!1})}catch(t){let s=t instanceof Error?t.message:"Unknown error";e({error:s,isLoading:!1}),console.error("Error updating pet:",s)}},updatePassword:async(s,t,a)=>{e({isLoading:!0,error:null});try{await r("/api/owner/".concat(s,"/reset-password"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:t,newPassword:a})}),e({isLoading:!1})}catch(t){let s=t instanceof Error?t.message:"Password update failed";e({error:s,isLoading:!1}),console.error("Error updating password:",s)}}}))}},e=>{var s=s=>e(e.s=s);e.O(0,[4688,1829,9539,7358],()=>s(69344)),_N_E=e.O()}]);