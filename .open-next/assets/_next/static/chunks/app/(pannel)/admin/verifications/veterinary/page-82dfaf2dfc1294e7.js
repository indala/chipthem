(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8405],{48352:(e,i,s)=>{Promise.resolve().then(s.bind(s,38456))},38456:(e,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>j});var r=s(22194),n=s(4346),a=s(38734),t=s(45699),c=s(94771),l=s(37439),d=s(2179);let o=(0,l.v)((e,i)=>({veterinaries:[],page:1,hasMore:!0,loading:!1,error:null,fetchVeterinaries:async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(i().loading)return;e({loading:!0,error:null});let r=s?1:i().page;try{let t=await fetch("/api/admin/veterinary?page=".concat(r)),c=await t.json();if(c.success){var n,a;e({veterinaries:s?c.veterinary_clinics:[...i().veterinaries,...c.veterinary_clinics],page:r+1,hasMore:null!==(a=null===(n=c.pagination)||void 0===n?void 0:n.hasMore)&&void 0!==a&&a,loading:!1})}else e({loading:!1,error:c.message})}catch(i){console.error("❌ Fetch veterinarians failed:",i),e({loading:!1,error:"Failed to fetch veterinarians."})}},verifyVeterinary:async s=>{try{let r=await fetch("/api/admin/veterinary/".concat(s,"/verify"),{method:"PATCH"}),n=await r.json();if(!n.success)throw Error(n.message);e({veterinaries:i().veterinaries.map(e=>e.id===s?{...e,is_verified:!0,status:"verified"}:e)}),console.log("✅ Veterinary verified:",n.message)}catch(e){console.error("❌ Verify veterinary failed:",e)}},rejectVeterinary:async s=>{try{let r=await fetch("/api/admin/veterinary/".concat(s,"/reject"),{method:"DELETE"}),n=await r.json();if(!n.success)throw Error(n.message);e({veterinaries:i().veterinaries.filter(e=>e.id!==s)}),console.log("\uD83D\uDDD1️ Veterinary rejected:",n.message)}catch(e){console.error("❌ Reject veterinary failed:",e)}},subscribeRealtime:()=>{let s=d.m.channel("realtime:veterinary_clinics").on("system",{event:"postgres_changes",schema:"public",table:"veterinary_clinics"},s=>{let{eventType:r,new:n,old:a}=s,t=[...i().veterinaries];switch(r){case"INSERT":n&&!t.some(e=>e.id===n.id)&&e({veterinaries:[n,...t]});break;case"UPDATE":n&&e({veterinaries:t.map(e=>e.id===n.id?{...e,...n}:e)});break;case"DELETE":a&&e({veterinaries:t.filter(e=>e.id!==a.id)})}}).subscribe();return()=>{d.m.removeChannel(s)}}}));var m=s(26916),h=s(16386),u=s(64622),x=s(91665),v=s(19159);function f(e){let{vet:i,index:s,onView:n}=e,{verifyVeterinary:t,rejectVeterinary:c}=o();return(0,r.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"bg-white border rounded-4 shadow-sm p-3 d-flex flex-column justify-content-between",style:{width:"260px"},children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,r.jsx)("h6",{className:"fw-semibold text-truncate mb-0",children:i.clinic_name}),i.is_verified?(0,r.jsx)(h.A,{className:"text-success",size:20}):"pending"===i.status?(0,r.jsx)(u.A,{className:"text-warning",size:20}):(0,r.jsx)(x.A,{className:"text-danger",size:20})]}),(0,r.jsxs)("p",{className:"text-muted small mb-1 text-truncate",children:["\uD83D\uDCE7 ",i.email]}),i.phone&&(0,r.jsxs)("p",{className:"text-muted small mb-2 text-truncate",children:["\uD83D\uDCDE ",i.phone]}),(0,r.jsxs)("p",{className:"text-muted small mb-3",children:["\uD83E\uDE7A ",i.license_number?"License: ".concat(i.license_number):"No license info"]}),(0,r.jsxs)("div",{className:"d-flex justify-content-between mt-auto",children:[(0,r.jsx)(a.A,{size:"sm",variant:"outline-primary",onClick:()=>n(i),children:"View"}),(0,r.jsx)(a.A,{size:"sm",variant:"success",disabled:i.is_verified,onClick:()=>{if(!i.id){v.o.error("Missing veterinary clinic information");return}v.o.promise(t(i.id),{loading:"Verifying clinic...",success:"Clinic verified successfully!",error:"Failed to verify. Please try again."})},children:"Accept"}),(0,r.jsx)(a.A,{size:"sm",variant:"danger",onClick:()=>{if(!i.id){v.o.error("Missing veterinary clinic information");return}v.o.promise(c(i.id),{loading:"Rejecting...",success:"Clinic rejected successfully.",error:"Failed to reject. Please try again."})},children:"Reject"})]})]},i.id)}function j(){let{veterinaries:e,fetchVeterinaries:i,subscribeRealtime:s,hasMore:l,loading:d}=o(),[m,h]=(0,n.useState)(null),[u,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{i(!0)}),(0,n.useEffect)(()=>{let e=s();return()=>null==e?void 0:e()},[s]);let v=e=>{h(e),x(!0)},j=()=>x(!1);return(0,r.jsxs)("div",{className:"p-4 bg-light",children:[(0,r.jsx)("h2",{className:"fw-semibold mb-4",children:"\uD83C\uDFE5 Veterinary Clinic Verification"}),(0,r.jsx)("div",{className:"d-flex flex-wrap gap-3",children:e.map((e,i)=>(0,r.jsx)(f,{vet:e,index:i,onView:v},e.id))}),l&&(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)(a.A,{onClick:()=>i(),disabled:d,variant:"outline-secondary",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.A,{animation:"border",size:"sm"})," Loading..."]}):"Load More"})}),(0,r.jsxs)(c.A,{show:u,onHide:j,centered:!0,children:[(0,r.jsx)(c.A.Header,{closeButton:!0,children:(0,r.jsx)(c.A.Title,{children:"Veterinary Clinic Details"})}),(0,r.jsx)(c.A.Body,{children:m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h6",{children:m.clinic_name}),(0,r.jsx)("p",{className:"text-muted mb-2",children:m.email}),m.phone&&(0,r.jsxs)("p",{className:"text-muted mb-2",children:["\uD83D\uDCDE ",m.phone]}),m.city&&(0,r.jsxs)("p",{className:"text-muted",children:["\uD83D\uDCCD ",m.city,", ",m.country||""]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("strong",{children:"Status:"})," ",m.is_verified?"Verified":"Unverified"]}),(0,r.jsx)("h6",{className:"mt-3",children:"\uD83E\uDE7A Clinic Info"}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:["License: ",m.license_number||"N/A"]}),(0,r.jsxs)("li",{children:["Years in Practice: ",m.years_in_practice||"N/A"]}),(0,r.jsxs)("li",{children:["Provides 24H Emergency: ",m.provides_24h_emergency?"Yes":"No"]}),(0,r.jsxs)("li",{children:["Microchip Services: ",m.microchip_services?"Yes":"No"]}),(0,r.jsxs)("li",{children:["Has Scanners: ",m.has_microchip_scanners?"Yes":"No"]})]})]}):(0,r.jsx)("div",{className:"text-center py-3",children:(0,r.jsx)(t.A,{animation:"border"})})}),(0,r.jsx)(c.A.Footer,{children:(0,r.jsx)(a.A,{variant:"secondary",onClick:j,children:"Close"})})]})]})}},2179:(e,i,s)=>{"use strict";s.d(i,{m:()=>r});let r=(0,s(3830).UU)("https://zwqngfcujvsaahykqisj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3cW5nZmN1anZzYWFoeWtxaXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNTczNjYsImV4cCI6MjA3NzczMzM2Nn0.TYScA96_QA1pTsZVDty3f4fPDTJRUfbfTtVP9amTuxg")}},e=>{var i=i=>e(e.s=i);e.O(0,[6916,9159,5399,7750,1829,9539,7358],()=>i(48352)),_N_E=e.O()}]);