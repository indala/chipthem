(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8405],{48352:(e,s,i)=>{Promise.resolve().then(i.bind(i,38456))},38456:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>b});var r=i(22194),t=i(4346),a=i(37439),n=i(2179);let c=(0,a.v)((e,s)=>({veterinaries:[],page:1,hasMore:!0,loading:!1,error:null,fetchVeterinaries:async function(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(s().loading)return;e({loading:!0,error:null});let r=i?1:s().page;try{let n=await fetch("/api/admin/veterinary?page=".concat(r)),c=await n.json();if(c.success){var t,a;e({veterinaries:i?c.veterinary_clinics:[...s().veterinaries,...c.veterinary_clinics],page:r+1,hasMore:null!==(a=null===(t=c.pagination)||void 0===t?void 0:t.hasMore)&&void 0!==a&&a,loading:!1})}else e({loading:!1,error:c.message})}catch(s){console.error("❌ Fetch veterinarians failed:",s),e({loading:!1,error:"Failed to fetch veterinarians."})}},verifyVeterinary:async i=>{try{let r=await fetch("/api/admin/veterinary/".concat(i,"/verify"),{method:"PATCH"}),t=await r.json();if(!t.success)throw Error(t.message);e({veterinaries:s().veterinaries.filter(e=>e.id!==i)}),console.log("✅ Veterinary verified:",t.message)}catch(e){console.error("❌ Verify veterinary failed:",e)}},rejectVeterinary:async i=>{try{let r=await fetch("/api/admin/veterinary/".concat(i,"/reject"),{method:"DELETE"}),t=await r.json();if(!t.success)throw Error(t.message);e({veterinaries:s().veterinaries.filter(e=>e.id!==i)}),console.log("\uD83D\uDDD1️ Veterinary rejected:",t.message)}catch(e){console.error("❌ Reject veterinary failed:",e)}},subscribeRealtime:()=>{let i=n.m.channel("realtime:veterinary_clinics").on("system",{event:"postgres_changes",schema:"public",table:"veterinary_clinics"},i=>{let{eventType:r,new:t,old:a}=i,n=[...s().veterinaries];switch(r){case"INSERT":t&&!n.some(e=>e.id===t.id)&&e({veterinaries:[t,...n]});break;case"UPDATE":t&&e({veterinaries:n.map(e=>e.id===t.id?{...e,...t}:e)});break;case"DELETE":a&&e({veterinaries:n.filter(e=>e.id!==a.id)})}}).subscribe();return()=>{n.m.removeChannel(i)}}}));var l=i(26916),o=i(16386),d=i(64622),m=i(91665),x=i(19159),g=i(43821);let h=e=>{let{onClick:s,disabled:i,variant:t,size:a,children:n,className:c=""}=e,l="font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 flex items-center justify-center ";return"sm"===a?l+="px-3 py-1 text-sm ":l+="px-4 py-2 ","success"===t?l+="bg-green-600 hover:bg-green-700 text-white focus:ring-green-300":"danger"===t?l+="bg-red-600 hover:bg-red-700 text-white focus:ring-red-300":"outline-primary"===t?l+="border border-indigo-500 text-indigo-600 hover:bg-indigo-50 focus:ring-indigo-200":l+="bg-gray-200 hover:bg-gray-300 text-gray-800 focus:ring-gray-300",i&&(l+=" opacity-50 cursor-not-allowed"),(0,r.jsx)("button",{onClick:s,disabled:i,className:"".concat(l," ").concat(c),children:n})};function u(e){let{vet:s,index:i,onView:t}=e,{verifyVeterinary:a,rejectVeterinary:n}=c();return(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*i},className:"bg-white border border-gray-200 rounded-xl shadow-md p-4 flex flex-col justify-between h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h6",{className:"font-semibold text-lg truncate mb-0 text-gray-800",children:s.clinic_name}),s.is_verified?(0,r.jsx)(o.A,{className:"text-green-500",size:20}):"pending"===s.status?(0,r.jsx)(d.A,{className:"text-yellow-500",size:20}):(0,r.jsx)(m.A,{className:"text-red-500",size:20})]}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm mb-1 truncate flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"\uD83D\uDCE7"})," ",s.email]}),s.phone&&(0,r.jsxs)("p",{className:"text-gray-500 text-sm mb-2 truncate flex items-center",children:[(0,r.jsx)("span",{className:"mr-1",children:"\uD83D\uDCDE"})," ",s.phone]}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm mb-3",children:["\uD83E\uDE7A ",s.license_number?"License: ".concat(s.license_number):"No license info"]})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-auto space-x-2 pt-3 border-t border-gray-100",children:[(0,r.jsxs)(h,{size:"sm",variant:"outline-primary",onClick:()=>t(s),className:"w-1/3",children:[(0,r.jsx)(g.Ny1,{className:"mr-1"})," View"]}),(0,r.jsxs)(h,{size:"sm",variant:"success",disabled:s.is_verified,onClick:()=>{if(!s.id){x.o.error("Missing veterinary clinic information");return}x.o.promise(a(s.id),{loading:"Verifying clinic...",success:"Clinic verified successfully!",error:"Failed to verify. Please try again."})},className:"w-1/3",children:[(0,r.jsx)(g.A7C,{className:"mr-1"})," Accept"]}),(0,r.jsxs)(h,{size:"sm",variant:"danger",onClick:()=>{if(!s.id){x.o.error("Missing veterinary clinic information");return}x.o.promise(n(s.id),{loading:"Rejecting...",success:"Clinic rejected successfully.",error:"Failed to reject. Please try again."})},className:"w-1/3",children:[(0,r.jsx)(g._Hm,{className:"mr-1"})," Reject"]})]})]},s.id)}let f=()=>(0,r.jsx)(g.hW,{className:"animate-spin text-green-600 w-5 h-5 mr-2"}),y=e=>{let{onClick:s,disabled:i,variant:t,children:a,className:n=""}=e,c="px-6 py-3 font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-4 ";return"secondary"===t?c+="bg-gray-500 hover:bg-gray-600 text-white focus:ring-gray-300":"outline-secondary"===t?c+="border border-green-300 text-green-700 hover:bg-green-50 focus:ring-green-200":c+="bg-green-600 hover:bg-green-700 text-white focus:ring-green-300",i&&(c+=" opacity-50 cursor-not-allowed"),(0,r.jsx)("button",{onClick:s,disabled:i,className:"".concat(c," ").concat(n," flex items-center justify-center"),children:a})},j=e=>{let{show:s,onClose:i,vet:t}=e;return s?(0,r.jsx)("div",{className:"fixed inset-0  bg-black bg-opacity-50 flex justify-center items-center p-4","aria-modal":"true",role:"dialog",onClick:i,children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full transform transition-all duration-300 scale-100",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-5 border-b border-gray-200",children:[(0,r.jsx)("h5",{className:"text-xl font-bold text-gray-900",children:"Veterinary Clinic Details"}),(0,r.jsx)("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(g.QCr,{className:"w-6 h-6"})})]}),(0,r.jsx)("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:t?(0,r.jsxs)("div",{children:[(0,r.jsx)("h6",{className:"text-2xl font-semibold text-green-600 mb-1",children:t.clinic_name}),(0,r.jsx)("div",{className:"bg-green-50 p-3 rounded-lg mb-4 text-sm",children:(0,r.jsxs)("p",{className:"mb-0 font-medium",children:[(0,r.jsx)("strong",{children:"Status:"}),(0,r.jsx)("span",{className:"ml-1 font-bold ".concat(t.is_verified?"text-green-700":"text-yellow-600"),children:t.is_verified?"Verified":"Unverified"})]})}),(0,r.jsxs)("div",{className:"space-y-2 text-gray-700 mb-6",children:[(0,r.jsxs)("p",{className:"text-sm flex items-center",children:[(0,r.jsx)(g.maD,{className:"mr-2 text-gray-400"}),t.email]}),t.phone&&(0,r.jsxs)("p",{className:"text-sm flex items-center",children:[(0,r.jsx)(g.dRU,{className:"mr-2 text-gray-400"}),t.phone]}),t.city&&(0,r.jsxs)("p",{className:"text-sm flex items-center",children:[(0,r.jsx)(g.vq8,{className:"mr-2 text-gray-400"}),t.city,", ",t.country||""]})]}),(0,r.jsxs)("h6",{className:"text-lg font-bold text-gray-700 mb-3 flex items-center border-t pt-3",children:[(0,r.jsx)(g.dr3,{className:"mr-2 text-green-500"})," Additional Info"]}),(0,r.jsxs)("ul",{className:"list-disc list-inside text-gray-700 space-y-1 text-sm",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"License:"})," ",t.license_number||"N/A"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Years in Practice:"})," ",t.years_in_practice||"N/A"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"24H Emergency:"})," ",(0,r.jsx)("span",{className:t.provides_24h_emergency?"text-green-600 font-medium":"text-red-500",children:t.provides_24h_emergency?"Yes":"No"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Microchip Services:"})," ",(0,r.jsx)("span",{className:t.microchip_services?"text-green-600 font-medium":"text-red-500",children:t.microchip_services?"Yes":"No"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"font-semibold",children:"Has Scanners:"})," ",(0,r.jsx)("span",{className:t.has_microchip_scanners?"text-green-600 font-medium":"text-red-500",children:t.has_microchip_scanners?"Yes":"No"})]})]})]}):(0,r.jsx)("div",{className:"flex justify-center py-6",children:(0,r.jsx)(f,{})})}),(0,r.jsx)("div",{className:"flex justify-end p-4 border-t border-gray-200",children:(0,r.jsx)(y,{variant:"secondary",onClick:i,children:"Close"})})]})}):null};function b(){let{veterinaries:e,hasMore:s,loading:i}=c(),a=c(e=>e.fetchVeterinaries),n=c(e=>e.subscribeRealtime),[l,o]=(0,t.useState)(null),[d,m]=(0,t.useState)(!1),x=(0,t.useCallback)(e=>{a(e)},[a]),h=(0,t.useCallback)(()=>n(),[n]);(0,t.useEffect)(()=>{x(!0)},[x]),(0,t.useEffect)(()=>{let e=h();return()=>null==e?void 0:e()},[h]);let b=e=>{o(e),m(!0)};return(0,r.jsxs)("div",{className:"p-6 md:p-8 bg-gray-50 min-h-screen",children:[(0,r.jsxs)("h2",{className:"text-3xl font-bold text-gray-800 mb-6 flex items-center",children:[(0,r.jsx)(g.v3G,{className:"mr-3 text-green-600"})," Veterinary Clinic Verification"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map((e,s)=>(0,r.jsx)(u,{vet:e,index:s,onView:b},e.id))}),s&&(0,r.jsx)("div",{className:"text-center mt-8",children:(0,r.jsx)(y,{onClick:()=>x(),disabled:i,variant:"outline-secondary",className:"min-w-[200px]",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{})," Loading..."]}):"Load More Clinics"})}),(0,r.jsx)(j,{show:d,onClose:()=>m(!1),vet:l})]})}},2179:(e,s,i)=>{"use strict";i.d(s,{m:()=>r});let r=(0,i(3830).UU)("https://zwqngfcujvsaahykqisj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3cW5nZmN1anZzYWFoeWtxaXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNTczNjYsImV4cCI6MjA3NzczMzM2Nn0.TYScA96_QA1pTsZVDty3f4fPDTJRUfbfTtVP9amTuxg")}},e=>{var s=s=>e(e.s=s);e.O(0,[2912,6916,9159,238,1829,9539,7358],()=>s(48352)),_N_E=e.O()}]);