(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3637],{48087:(e,t,s)=>{Promise.resolve().then(s.bind(s,24726))},24726:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var l=s(22194),a=s(4346);let r=(0,s(16474).v)(e=>({analytics:null,loading:!1,error:null,fetchAnalytics:async()=>{e({loading:!0,error:null});try{let t=await fetch("/api/admin/analytics",{cache:"no-store"});if(!t.ok)throw Error("Failed to load analytics data");let s=await t.json();e({analytics:{pets:s.pets||[],lostReports:s.lostReports||[],foundReports:s.foundReports||[],owners:s.owners||[],vets:s.vets||[]},loading:!1})}catch(t){console.error("Analytics fetch error:",t),e({error:"Unable to load analytics data",loading:!1})}}}));var n=s(19919),i=s(2377),d=s(7004),o=s(76911),c=s(95521),u=s(35858),h=s(36374),x=s(41881),f=s(17561),g=s(65498),m=s(67180),p=s(47728),j=s(66689),b=s(28928),v=s(52856),w=s(97214),y=s(60575);let N={"7d":7,"30d":30,"6m":180,"12m":365,all:1/0};function R(e){let t=new Date(e);return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))}let k={blue:["#3b82f6","#60a5fa"],green:["#10b981","#34d399"],purple:["#8b5cf6","#a78bfa"],yellow:["#facc15","#fcd34d"],orange:["#f97316","#fb923c"],red:["#ef4444","#f87171"],teal:["#14b8a6","#2dd4bf"],gray:["#9ca3af","#d1d5db"]};function _(){let{analytics:e,loading:t,error:s,fetchAnalytics:_}=r(),[A,K]=(0,a.useState)("12m");(0,a.useEffect)(()=>{e||t||_()},[e,t,_]);let E=(0,a.useMemo)(()=>{if(!e)return null;let t=N[A],s="all"===A?null:function(e){let t=new Date;return t.setDate(t.getDate()-e),t}(t);function l(e){return s?e.filter(e=>{if(!e.created_at)return!1;let t=new Date(e.created_at);return!isNaN(t.getTime())&&t>=s}):e.filter(e=>!!e.created_at&&!isNaN(new Date(e.created_at).getTime()))}return{pets:l(e.pets),owners:l(e.owners),vets:l(e.vets),lostReports:l(e.lostReports),foundReports:l(e.foundReports)}},[e,A]),D=(0,a.useMemo)(()=>{if(!E)return[];let e=new Map;return E.pets.forEach(t=>{if(!t.created_at)return;let s=new Date(t.created_at);if(isNaN(s.getTime()))return;let l=R(s);e.set(l,(e.get(l)||0)+1)}),[...e.entries()].map(e=>{let[t,s]=e;return{month:t,count:s}})},[E]),L=(0,a.useMemo)(()=>{if(!E)return[];let e=new Map;return E.lostReports.forEach(t=>{let s=R(t.created_at);e.has(s)||e.set(s,{lost:0,found:0}),e.get(s).lost++}),E.foundReports.forEach(t=>{let s=R(t.created_at);e.has(s)||e.set(s,{lost:0,found:0}),e.get(s).found++}),[...e.entries()].map(e=>{let[t,s]=e;return{month:t,...s}})},[E]),M=(0,a.useMemo)(()=>{if(!E)return[];let e={dog:0,cat:0,bird:0,other:0};return E.pets.forEach(t=>{let s=(t.pet_type||"other").toLowerCase();s.includes("dog")?e.dog++:s.includes("cat")?e.cat++:s.includes("bird")?e.bird++:e.other++}),Object.entries(e).map(e=>{let[t,s]=e;return{name:t,value:s}})},[E]),P=(0,a.useMemo)(()=>{if(!E)return[];let e=E.owners.filter(e=>e.is_verified).length,t=E.owners.length-e,s=E.vets.filter(e=>e.is_verified).length,l=E.vets.length-s;return[{name:"Owners - Verified",value:e,color:k.green[0]},{name:"Owners - Unverified",value:t,color:k.yellow[0]},{name:"Vets - Verified",value:s,color:k.blue[0]},{name:"Vets - Unverified",value:l,color:k.orange[0]}]},[E]),T=(0,a.useMemo)(()=>{if(!E)return[];let e=E.lostReports.filter(e=>"resolved"===e.status).length,t=E.lostReports.length-e,s=E.foundReports.filter(e=>"resolved"===e.status).length,l=E.foundReports.length-s;return[{category:"Lost",resolved:e,unresolved:t},{category:"Found",resolved:s,unresolved:l}]},[E]);return t?(0,l.jsx)("div",{className:"p-8 text-center",children:"Loading analytics..."}):s?(0,l.jsx)("div",{className:"p-8 text-center text-red-600",children:s}):E?(0,l.jsxs)("div",{className:"p-8 space-y-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold",children:"Analytics Overview"}),(0,l.jsxs)("select",{value:A,onChange:e=>K(e.target.value),className:"   border rounded-xl px-3 py-2 shadow   bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500   text-white font-semibold   focus:outline-none focus:ring-2 focus:ring-purple-400   ",children:[(0,l.jsx)("option",{className:"text-black",value:"7d",children:"Last 7 days"}),(0,l.jsx)("option",{className:"text-black",value:"30d",children:"Last 30 days"}),(0,l.jsx)("option",{className:"text-black",value:"6m",children:"Last 6 months"}),(0,l.jsx)("option",{className:"text-black",value:"12m",children:"Last 12 months"}),(0,l.jsx)("option",{className:"text-black",value:"all",children:"All time"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[(0,l.jsx)(j.A,{label:"Total Owners",value:E.owners.length,icon:(0,l.jsx)(b.A,{}),color:"blue",description:"Registered owners"}),(0,l.jsx)(j.A,{label:"Total Vets",value:E.vets.length,icon:(0,l.jsx)(v.A,{}),color:"green",description:"Registered clinics"}),(0,l.jsx)(j.A,{label:"Total Pets",value:E.pets.length,icon:(0,l.jsx)(w.A,{}),color:"purple",description:"Registered pets"}),(0,l.jsx)(j.A,{label:"Total Reports",value:E.lostReports.length+E.foundReports.length,icon:(0,l.jsx)(y.A,{}),color:"red",description:"Lost + Found reports"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white/5 backdrop-blur rounded-xl p-4 shadow",children:[(0,l.jsxs)("h2",{className:"text-lg font-medium mb-2",children:["Pets Registered (",A.toUpperCase(),")"]}),(0,l.jsx)("div",{style:{width:"100%",height:280},children:(0,l.jsx)(n.u,{width:"100%",height:"100%",children:(0,l.jsxs)(i.b,{data:D,children:[(0,l.jsx)(d.W,{dataKey:"month",tick:{fontSize:12}}),(0,l.jsx)(o.h,{allowDecimals:!1}),(0,l.jsx)(c.m,{}),(0,l.jsx)(u.N1,{type:"monotone",dataKey:"count",stroke:k.purple[0],strokeWidth:3})]})})})]}),(0,l.jsxs)("div",{className:"bg-white/5 backdrop-blur rounded-xl p-4 shadow",children:[(0,l.jsxs)("h2",{className:"text-lg font-medium mb-2",children:["Lost vs Found (",A.toUpperCase(),")"]}),(0,l.jsx)("div",{style:{width:"100%",height:280},children:(0,l.jsx)(n.u,{width:"100%",height:"100%",children:(0,l.jsxs)(h.E,{data:L,children:[(0,l.jsx)(d.W,{dataKey:"month",tick:{fontSize:12}}),(0,l.jsx)(o.h,{allowDecimals:!1}),(0,l.jsx)(c.m,{}),(0,l.jsx)(x.s,{}),(0,l.jsx)(f.yP,{dataKey:"lost",fill:k.red[0]}),(0,l.jsx)(f.yP,{dataKey:"found",fill:k.green[0]})]})})})]}),(0,l.jsxs)("div",{className:"bg-white/5 backdrop-blur rounded-xl p-4 shadow",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Pets by Type"}),(0,l.jsx)("div",{style:{width:"100%",height:280},className:"flex items-center justify-center",children:(0,l.jsx)(n.u,{width:"100%",height:"100%",children:(0,l.jsxs)(g.r,{children:[(0,l.jsx)(m.Fq,{data:M,dataKey:"value",nameKey:"name",outerRadius:90,innerRadius:40,label:!0,children:M.map((e,t)=>{let s=[k.blue[0],k.purple[0],k.teal[0],k.gray[0]];return(0,l.jsx)(p.f,{fill:s[t]},t)})}),(0,l.jsx)(x.s,{}),(0,l.jsx)(c.m,{})]})})})]}),(0,l.jsxs)("div",{className:"bg-white/5 backdrop-blur rounded-xl p-4 shadow",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-2",children:"Verification Breakdown"}),(0,l.jsx)("div",{style:{width:"100%",height:280},className:"flex items-center justify-center",children:(0,l.jsx)(n.u,{width:"100%",height:"100%",children:(0,l.jsxs)(g.r,{children:[(0,l.jsx)(m.Fq,{data:P,dataKey:"value",nameKey:"name",outerRadius:90,innerRadius:50,label:!0,children:P.map((e,t)=>(0,l.jsx)(p.f,{fill:e.color},t))}),(0,l.jsx)(x.s,{}),(0,l.jsx)(c.m,{})]})})})]}),(0,l.jsxs)("div",{className:"bg-white/5 backdrop-blur rounded-xl p-4 shadow lg:col-span-2",children:[(0,l.jsxs)("h2",{className:"text-lg font-medium mb-2",children:["Resolution Status (",A.toUpperCase(),")"]}),(0,l.jsx)("div",{style:{width:"100%",height:280},children:(0,l.jsx)(n.u,{width:"100%",height:"100%",children:(0,l.jsxs)(h.E,{data:T,children:[(0,l.jsx)(d.W,{dataKey:"category",tick:{fontSize:12}}),(0,l.jsx)(o.h,{allowDecimals:!1}),(0,l.jsx)(c.m,{}),(0,l.jsx)(x.s,{}),(0,l.jsx)(f.yP,{dataKey:"unresolved",fill:k.red[0]}),(0,l.jsx)(f.yP,{dataKey:"resolved",fill:k.green[0]})]})})})]})]})]}):null}},66689:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var l=s(22194),a=s(76314),r=s.n(a);let n={blue:"linear-gradient(135deg, #3b82f6, #60a5fa)",green:"linear-gradient(135deg, #10b981, #34d399)",purple:"linear-gradient(135deg, #8b5cf6, #a78bfa)",yellow:"linear-gradient(135deg, #facc15, #fcd34d)",orange:"linear-gradient(135deg, #f97316, #fb923c)",red:"linear-gradient(135deg, #ef4444, #f87171)",teal:"linear-gradient(135deg, #14b8a6, #2dd4bf)",gray:"linear-gradient(135deg, #9ca3af, #d1d5db)"};function i(e){let{label:t,value:s,icon:a,color:i="gray",description:d,href:o}=e,c=n[i]||n.gray,u=(0,l.jsx)("div",{className:"h-full",children:(0,l.jsxs)("div",{className:"h-full p-6 rounded-lg shadow flex flex-col justify-between space-y-4   transition-transform hover:scale-[1.03] cursor-pointer",style:{background:c},children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[a&&(0,l.jsx)("div",{className:"".concat("text-".concat(i,"-100")," text-4xl"),children:a}),(0,l.jsxs)("div",{className:"text-white",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:t}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold",children:s})]})]}),d&&(0,l.jsx)("p",{className:"text-sm text-white/80 mt-1",children:d})]})});return o?(0,l.jsx)(r(),{href:o,children:u}):u}}},e=>{var t=t=>e(e.s=t);e.O(0,[6314,8937,1884,1829,9539,7358],()=>t(48087)),_N_E=e.O()}]);