(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7914],{17537:(e,s,t)=>{Promise.resolve().then(t.bind(t,50304))},50304:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var i=t(22194),n=t(4346),a=t(38734),r=t(45699),c=t(94771),l=t(37439),d=t(2179);let o=(0,l.v)((e,s)=>({pets:[],page:1,hasMore:!0,loading:!1,error:null,fetchPets:async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(s().loading)return;e({loading:!0,error:null});let i=t?1:s().page;try{let r=await fetch("/api/admin/pets?page=".concat(i)),c=await r.json();if(c.success){var n,a;e({pets:t?c.pets:[...s().pets,...c.pets],page:i+1,hasMore:null!==(a=null===(n=c.pagination)||void 0===n?void 0:n.hasMore)&&void 0!==a&&a,loading:!1})}else e({loading:!1,error:c.message})}catch(s){console.error("❌ Fetch pets failed:",s),e({loading:!1,error:"Failed to fetch pets."})}},verifyPet:async t=>{try{let i=await fetch("/api/admin/pets/".concat(t,"/verify"),{method:"PATCH"}),n=await i.json();if(!n.success)throw Error(n.message);e({pets:s().pets.map(e=>e.id===t?{...e,is_verified:!0,status:"verified"}:e)})}catch(e){console.error("❌ Verify pet failed:",e)}},rejectPet:async t=>{try{let i=await fetch("/api/admin/pets/".concat(t,"/reject"),{method:"DELETE"}),n=await i.json();if(!n.success)throw Error(n.message);e({pets:s().pets.filter(e=>e.id!==t)})}catch(e){console.error("❌ Reject pet failed:",e)}},subscribeRealtime:()=>{let t=d.m.channel("realtime:pets").on("system",{event:"postgres_changes",schema:"public",table:"pets"},t=>{let{eventType:i,new:n,old:a}=t,r=[...s().pets];switch(i){case"INSERT":n&&!r.some(e=>e.id===n.id)&&e({pets:[n,...r]});break;case"UPDATE":n&&e({pets:r.map(e=>e.id===n.id?{...e,...n}:e)});break;case"DELETE":a&&e({pets:r.filter(e=>e.id!==a.id)})}}).subscribe();return()=>d.m.removeChannel(t)}}));var m=t(26916),p=t(16386),u=t(64622),h=t(91665),x=t(19159);function f(e){let{pet:s,index:t,onView:n}=e,{verifyPet:r,rejectPet:c}=o();return(0,i.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-white border rounded-4 shadow-sm p-3 d-flex flex-column justify-content-between",style:{width:"260px"},children:[(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,i.jsx)("h6",{className:"fw-semibold text-truncate mb-0",children:s.pet_name}),s.is_verified?(0,i.jsx)(p.A,{className:"text-success",size:20}):"pending"===s.status?(0,i.jsx)(u.A,{className:"text-warning",size:20}):(0,i.jsx)(h.A,{className:"text-danger",size:20})]}),(0,i.jsx)("p",{className:"text-muted small mb-1",children:s.pet_type||"Unknown type"}),s.owner&&(0,i.jsxs)("p",{className:"text-muted small mb-3 text-truncate",children:["\uD83D\uDC64 ",s.owner.full_name," (",s.owner.email,")"]}),(0,i.jsxs)("div",{className:"d-flex justify-content-between mt-auto",children:[(0,i.jsx)(a.A,{size:"sm",variant:"outline-primary",onClick:()=>n(s),children:"View"}),(0,i.jsx)(a.A,{size:"sm",variant:"success",disabled:s.is_verified,onClick:()=>{if(!s.id){x.o.error("Missing pet information");return}x.o.promise(r(s.id),{loading:"Verifying pet...",success:"Pet verified successfully!",error:"Failed to verify pet. Please try again."})},children:"Accept"}),(0,i.jsx)(a.A,{size:"sm",variant:"danger",onClick:()=>{if(!s.id){x.o.error("Missing pet information");return}x.o.promise(c(s.id),{loading:"Rejecting pet...",success:"Pet rejected successfully!",error:"Failed to reject pet. Please try again."})},children:"Reject"})]})]},s.id)}function j(){let{pets:e,fetchPets:s,subscribeRealtime:t,hasMore:l,loading:d}=o(),[m,p]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{s(!0)}),(0,n.useEffect)(()=>{let e=t();return()=>null==e?void 0:e()});let x=e=>{p(e),h(!0)},j=()=>h(!1);return(0,i.jsxs)("div",{className:"p-4 bg-light",children:[(0,i.jsx)("h2",{className:"fw-semibold mb-4",children:"\uD83D\uDC3E Pet Verification"}),(0,i.jsx)("div",{className:"d-flex flex-wrap gap-3",children:e.map((e,s)=>(0,i.jsx)(f,{pet:e,index:s,onView:x},e.id))}),l&&(0,i.jsx)("div",{className:"text-center mt-4",children:(0,i.jsx)(a.A,{onClick:()=>s(),disabled:d,variant:"outline-secondary",children:d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.A,{animation:"border",size:"sm"})," Loading..."]}):"Load More"})}),(0,i.jsxs)(c.A,{show:u,onHide:j,centered:!0,children:[(0,i.jsx)(c.A.Header,{closeButton:!0,children:(0,i.jsx)(c.A.Title,{children:"Pet Details"})}),(0,i.jsx)(c.A.Body,{children:m?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h5",{children:m.pet_name}),(0,i.jsx)("p",{className:"text-muted mb-2",children:m.pet_type||"Unknown type"}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("strong",{children:"Status:"})," ",m.status||"N/A"," – ",m.is_verified?"Verified":"Unverified"]}),m.owner&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h6",{className:"mt-3",children:"\uD83D\uDC64 Owner"}),(0,i.jsx)("p",{children:m.owner.full_name}),(0,i.jsx)("p",{className:"text-muted mb-2",children:m.owner.email}),m.owner.phone_number&&(0,i.jsxs)("p",{className:"text-muted mb-2",children:["\uD83D\uDCDE ",m.owner.phone_number]}),m.owner.city&&(0,i.jsxs)("p",{className:"text-muted",children:["\uD83D\uDCCD ",m.owner.city,", ",m.owner.country||""]})]})]}):(0,i.jsx)("div",{className:"text-center py-3",children:(0,i.jsx)(r.A,{animation:"border"})})}),(0,i.jsx)(c.A.Footer,{children:(0,i.jsx)(a.A,{variant:"secondary",onClick:j,children:"Close"})})]})]})}},2179:(e,s,t)=>{"use strict";t.d(s,{m:()=>i});let i=(0,t(3830).UU)("https://zwqngfcujvsaahykqisj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3cW5nZmN1anZzYWFoeWtxaXNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNTczNjYsImV4cCI6MjA3NzczMzM2Nn0.TYScA96_QA1pTsZVDty3f4fPDTJRUfbfTtVP9amTuxg")}},e=>{var s=s=>e(e.s=s);e.O(0,[6916,9159,5399,7750,1829,9539,7358],()=>s(17537)),_N_E=e.O()}]);